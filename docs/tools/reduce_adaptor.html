<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>protkit.tools.reduce_adaptor API documentation</title>
<meta name="description" content="Implements class ReduceAdaptor. The ReduceAdaptor class provides an interface
to the Reduce software, which is used to add hydrogens to protein â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>protkit.tools.reduce_adaptor</code></h1>
</header>
<section id="section-intro">
<p>Implements class ReduceAdaptor. The ReduceAdaptor class provides an interface
to the Reduce software, which is used to add hydrogens to protein structures.</p>
<p>The Reduce software is a widely used tool for adding hydrogen atoms to protein
structures. It is used to prepare protein structures for molecular dynamics
simulations, docking studies, and other computational analyses.</p>
<p>To use the ReduceAdaptor class, you need to have the Reduce software installed.
You can download Reduce from the following website:
<a href="https://github.com/rlabduke/reduce">https://github.com/rlabduke/reduce</a></p>
<p>Reduce was developed by the Richardson Lab at Duke University. If you use
Reduce in your research, please cite the following paper:</p>
<p>Word, J. M., Lovell, S. C., Richardson, J. S., &amp; Richardson, D. C. (1999).
Asparagine and glutamine: using hydrogen atom contacts in the choice of side-chain
amide orientation. Journal of Molecular Biology, 285(4), 1735-1747.
<a href="https://doi.org/10.1006/jmbi.1998.2401">https://doi.org/10.1006/jmbi.1998.2401</a></p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#!/usr/bin/env python3
# -*- coding:utf-8 -*-
# Authors:  Fred Senekal (FS), Claudio Jardim (CJ)
# Contact:  fred@silicogenesis.com
# License:  GPLv3

&#34;&#34;&#34;
Implements class ReduceAdaptor. The ReduceAdaptor class provides an interface
to the Reduce software, which is used to add hydrogens to protein structures.

The Reduce software is a widely used tool for adding hydrogen atoms to protein
structures. It is used to prepare protein structures for molecular dynamics
simulations, docking studies, and other computational analyses.

To use the ReduceAdaptor class, you need to have the Reduce software installed.
You can download Reduce from the following website:
https://github.com/rlabduke/reduce

Reduce was developed by the Richardson Lab at Duke University. If you use
Reduce in your research, please cite the following paper:

Word, J. M., Lovell, S. C., Richardson, J. S., &amp; Richardson, D. C. (1999).
Asparagine and glutamine: using hydrogen atom contacts in the choice of side-chain
amide orientation. Journal of Molecular Biology, 285(4), 1735-1747.
https://doi.org/10.1006/jmbi.1998.2401
&#34;&#34;&#34;

import subprocess

from protkit.file_io import PDBIO
from protkit.structure import Protein
from protkit.tasks.protonator import Protonator


class ReduceProtonationError(Exception):
    pass


class ReduceDeprotonationError(Exception):
    pass


class ReduceAdaptor(Protonator):
    &#34;&#34;&#34;
    Adapter class for the Reduce software.

    This class provides a concrete implementation of the Protonator class,
    by interfacing with the Reduce software and updating Protein objects
    with the protonated structure.
    &#34;&#34;&#34;

    def __init__(self,
                 reduce_bin_path: str,
                 quiet: bool = False):
        &#34;&#34;&#34;
        Initialize the Reduce adaptor.

        Args:
            reduce_bin_path (str): The path to the Reduce binary.
            quiet (bool): Whether to suppress Reduce output.
        &#34;&#34;&#34;
        super().__init__()

        self._reduce_bin_path = reduce_bin_path
        self._quiet = quiet

    @staticmethod
    def merge_copy(source_protein: Protein, updated_protein: Protein) -&gt; Protein:
        &#34;&#34;&#34;
        Merge the updated protein into the source protein. The source protein
        is copied before the merge operation.

        Args:
            source_protein (Protein): The source protein.
            updated_protein (Protein): The updated protein.

        Returns:
            Protein: The merged protein.
        &#34;&#34;&#34;
        merged_protein = source_protein.copy()
        ReduceAdaptor.merge_into(merged_protein, updated_protein)
        return merged_protein

    @staticmethod
    def merge_into(source_protein: Protein, updated_protein: Protein):
        &#34;&#34;&#34;
        Merge the updated protein into the source protein. The source
        protein is updated in place.

        Args:
            source_protein (Protein): The source protein.
            updated_protein (Protein): The updated protein.

        Returns:
            None
        &#34;&#34;&#34;
        for chain in updated_protein.chains:
            source_chain = source_protein.get_chain(chain.chain_id)
            if source_chain is None:
                source_protein.add_chain(chain.chain_id, chain)
            else:
                for index, residue in enumerate(chain.residues):
                    source_residue = source_chain.get_residue(index)
                    if source_residue is None:
                        source_chain.add_residue(residue)
                    else:
                        for atom in residue.atoms:
                            source_atom = source_residue.get_atom(atom.atom_type)
                            if source_atom is None:
                                source_residue.add_atom(atom.atom_type, atom)
                            else:
                                source_atom.x = atom.x
                                source_atom.y = atom.y
                                source_atom.z = atom.z
                                if atom.has_attribute(&#34;temp_factor&#34;):
                                    source_atom.set_attribute(&#34;temp_factor&#34;, atom.get_attribute(&#34;temp_factor&#34;))

    def _reduce_protonate(self, pdb_str: str) -&gt; str:
        &#34;&#34;&#34;
        Protonate a protein using the Reduce software.

        Args:
            pdb_str (str): The PDB file as a string.

        Returns:
            str: The protonated PDB file as a string.
        &#34;&#34;&#34;
        if self._quiet:
            args = [self._reduce_bin_path, &#34;-quiet&#34;, &#34;-build&#34;, &#34;-&#34;]
        else:
            args = [self._reduce_bin_path, &#34;-build&#34;, &#34;-&#34;]
        protonate_process = subprocess.Popen(args,
                                             stdin=subprocess.PIPE,
                                             stdout=subprocess.PIPE)
        protonate_process.stdin.write(pdb_str.encode())
        stdout, stderr = protonate_process.communicate()
        protonate_process_out = stdout.decode(&#34;utf8&#34;)
        protonate_process.stdin.close()
        if protonate_process.stderr is not None:
            raise ReduceProtonationError(
                &#34;Error while protonating the protein.&#34;
            )
        return protonate_process_out

    def _reduce_deprotonate(self, pdb_str: str) -&gt; str:
        &#34;&#34;&#34;
        Deprotonate a protein using the Reduce software.

        Args:
            pdb_str (str): The PDB file as a string.

        Returns:
            str: The deprotonated PDB file as a string.
        &#34;&#34;&#34;
        if self._quiet:
            args = [self._reduce_bin_path, &#34;-quiet&#34;, &#34;-Trim&#34;, &#34;-&#34;]
        else:
            args = [self._reduce_bin_path, &#34;-Trim&#34;, &#34;-&#34;]
        deprotonate_process = subprocess.Popen(args,
                                               stdin=subprocess.PIPE,
                                               stdout=subprocess.PIPE)
        deprotonate_process.stdin.write(pdb_str.encode())
        stdout, stderr = deprotonate_process.communicate()
        deprotonate_process_output = stdout.decode(&#34;utf8&#34;)
        deprotonate_process.stdin.close()
        if deprotonate_process.stderr is not None:
            raise ReduceDeprotonationError(
                &#34;Error while deprotonating the protein before protonation.&#34;
            )
        return deprotonate_process_output

    def protonate(self, protein: Protein, reduce_output_pdb_file_path: str=None) -&gt; Protein:
        &#34;&#34;&#34;
        Protonate a protein using the Reduce software.

        Args:
            protein (Protein): The protein to be protonated.
            reduce_output_pdb_file_path (str): If set, the protonated PDB file
                as produced by Reduce will be saved to this path.

        Returns:
            Protein: The protonated protein.
        &#34;&#34;&#34;

        # Create an in memory PDB file
        input_pdb_str = PDBIO.save_to_string(protein)

        # Remove protons first, in case the structure is already protonated
        deprotonated_pdb_str = self._reduce_deprotonate(input_pdb_str)

        # Add hydrogens to the protein.
        protonated_pdb_str = self._reduce_protonate(deprotonated_pdb_str)
        if reduce_output_pdb_file_path is not None:
            with open(reduce_output_pdb_file_path, &#34;w&#34;) as file:
                file.write(protonated_pdb_str)

        # Merge the protonated protein with the original protein
        protein_out = PDBIO.load_from_string(protonated_pdb_str)[0]
        protein_merged = ReduceAdaptor.merge_copy(protein, protein_out)

        return protein_merged

    def deprotonate(self, protein: Protein, reduce_output_pdb_file_path: str=None) -&gt; Protein:
        &#34;&#34;&#34;
        Deprotonate a protein using the Reduce software.

        Args:
            protein (Protein): The protein to be deprotonated.
            reduce_output_pdb_file_path (str): If set, the deprotonated PDB file
                as produced by Reduce will be saved to this path.

        Returns:
            Protein: The deprotonated protein.
        &#34;&#34;&#34;

        # Create an in memory PDB file
        input_pdb_str = PDBIO.save_to_string(protein)

        # Remove hydrogen atoms from the structure.
        deprotonated_pdb_str = self._reduce_deprotonate(input_pdb_str)
        if reduce_output_pdb_file_path is not None:
            with open(reduce_output_pdb_file_path, &#34;w&#34;) as file:
                file.write(deprotonated_pdb_str)

        # Merge the deprotonated protein with the original protein
        protein_out = PDBIO.load_from_string(deprotonated_pdb_str)[0]
        protein_merged = ReduceAdaptor.merge_copy(protein, protein_out)

        return protein_merged</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="protkit.tools.reduce_adaptor.ReduceAdaptor"><code class="flex name class">
<span>class <span class="ident">ReduceAdaptor</span></span>
<span>(</span><span>reduce_bin_path:Â str, quiet:Â boolÂ =Â False)</span>
</code></dt>
<dd>
<div class="desc"><p>Adapter class for the Reduce software.</p>
<p>This class provides a concrete implementation of the Protonator class,
by interfacing with the Reduce software and updating Protein objects
with the protonated structure.</p>
<p>Initialize the Reduce adaptor.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>reduce_bin_path</code></strong> :&ensp;<code>str</code></dt>
<dd>The path to the Reduce binary.</dd>
<dt><strong><code>quiet</code></strong> :&ensp;<code>bool</code></dt>
<dd>Whether to suppress Reduce output.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ReduceAdaptor(Protonator):
    &#34;&#34;&#34;
    Adapter class for the Reduce software.

    This class provides a concrete implementation of the Protonator class,
    by interfacing with the Reduce software and updating Protein objects
    with the protonated structure.
    &#34;&#34;&#34;

    def __init__(self,
                 reduce_bin_path: str,
                 quiet: bool = False):
        &#34;&#34;&#34;
        Initialize the Reduce adaptor.

        Args:
            reduce_bin_path (str): The path to the Reduce binary.
            quiet (bool): Whether to suppress Reduce output.
        &#34;&#34;&#34;
        super().__init__()

        self._reduce_bin_path = reduce_bin_path
        self._quiet = quiet

    @staticmethod
    def merge_copy(source_protein: Protein, updated_protein: Protein) -&gt; Protein:
        &#34;&#34;&#34;
        Merge the updated protein into the source protein. The source protein
        is copied before the merge operation.

        Args:
            source_protein (Protein): The source protein.
            updated_protein (Protein): The updated protein.

        Returns:
            Protein: The merged protein.
        &#34;&#34;&#34;
        merged_protein = source_protein.copy()
        ReduceAdaptor.merge_into(merged_protein, updated_protein)
        return merged_protein

    @staticmethod
    def merge_into(source_protein: Protein, updated_protein: Protein):
        &#34;&#34;&#34;
        Merge the updated protein into the source protein. The source
        protein is updated in place.

        Args:
            source_protein (Protein): The source protein.
            updated_protein (Protein): The updated protein.

        Returns:
            None
        &#34;&#34;&#34;
        for chain in updated_protein.chains:
            source_chain = source_protein.get_chain(chain.chain_id)
            if source_chain is None:
                source_protein.add_chain(chain.chain_id, chain)
            else:
                for index, residue in enumerate(chain.residues):
                    source_residue = source_chain.get_residue(index)
                    if source_residue is None:
                        source_chain.add_residue(residue)
                    else:
                        for atom in residue.atoms:
                            source_atom = source_residue.get_atom(atom.atom_type)
                            if source_atom is None:
                                source_residue.add_atom(atom.atom_type, atom)
                            else:
                                source_atom.x = atom.x
                                source_atom.y = atom.y
                                source_atom.z = atom.z
                                if atom.has_attribute(&#34;temp_factor&#34;):
                                    source_atom.set_attribute(&#34;temp_factor&#34;, atom.get_attribute(&#34;temp_factor&#34;))

    def _reduce_protonate(self, pdb_str: str) -&gt; str:
        &#34;&#34;&#34;
        Protonate a protein using the Reduce software.

        Args:
            pdb_str (str): The PDB file as a string.

        Returns:
            str: The protonated PDB file as a string.
        &#34;&#34;&#34;
        if self._quiet:
            args = [self._reduce_bin_path, &#34;-quiet&#34;, &#34;-build&#34;, &#34;-&#34;]
        else:
            args = [self._reduce_bin_path, &#34;-build&#34;, &#34;-&#34;]
        protonate_process = subprocess.Popen(args,
                                             stdin=subprocess.PIPE,
                                             stdout=subprocess.PIPE)
        protonate_process.stdin.write(pdb_str.encode())
        stdout, stderr = protonate_process.communicate()
        protonate_process_out = stdout.decode(&#34;utf8&#34;)
        protonate_process.stdin.close()
        if protonate_process.stderr is not None:
            raise ReduceProtonationError(
                &#34;Error while protonating the protein.&#34;
            )
        return protonate_process_out

    def _reduce_deprotonate(self, pdb_str: str) -&gt; str:
        &#34;&#34;&#34;
        Deprotonate a protein using the Reduce software.

        Args:
            pdb_str (str): The PDB file as a string.

        Returns:
            str: The deprotonated PDB file as a string.
        &#34;&#34;&#34;
        if self._quiet:
            args = [self._reduce_bin_path, &#34;-quiet&#34;, &#34;-Trim&#34;, &#34;-&#34;]
        else:
            args = [self._reduce_bin_path, &#34;-Trim&#34;, &#34;-&#34;]
        deprotonate_process = subprocess.Popen(args,
                                               stdin=subprocess.PIPE,
                                               stdout=subprocess.PIPE)
        deprotonate_process.stdin.write(pdb_str.encode())
        stdout, stderr = deprotonate_process.communicate()
        deprotonate_process_output = stdout.decode(&#34;utf8&#34;)
        deprotonate_process.stdin.close()
        if deprotonate_process.stderr is not None:
            raise ReduceDeprotonationError(
                &#34;Error while deprotonating the protein before protonation.&#34;
            )
        return deprotonate_process_output

    def protonate(self, protein: Protein, reduce_output_pdb_file_path: str=None) -&gt; Protein:
        &#34;&#34;&#34;
        Protonate a protein using the Reduce software.

        Args:
            protein (Protein): The protein to be protonated.
            reduce_output_pdb_file_path (str): If set, the protonated PDB file
                as produced by Reduce will be saved to this path.

        Returns:
            Protein: The protonated protein.
        &#34;&#34;&#34;

        # Create an in memory PDB file
        input_pdb_str = PDBIO.save_to_string(protein)

        # Remove protons first, in case the structure is already protonated
        deprotonated_pdb_str = self._reduce_deprotonate(input_pdb_str)

        # Add hydrogens to the protein.
        protonated_pdb_str = self._reduce_protonate(deprotonated_pdb_str)
        if reduce_output_pdb_file_path is not None:
            with open(reduce_output_pdb_file_path, &#34;w&#34;) as file:
                file.write(protonated_pdb_str)

        # Merge the protonated protein with the original protein
        protein_out = PDBIO.load_from_string(protonated_pdb_str)[0]
        protein_merged = ReduceAdaptor.merge_copy(protein, protein_out)

        return protein_merged

    def deprotonate(self, protein: Protein, reduce_output_pdb_file_path: str=None) -&gt; Protein:
        &#34;&#34;&#34;
        Deprotonate a protein using the Reduce software.

        Args:
            protein (Protein): The protein to be deprotonated.
            reduce_output_pdb_file_path (str): If set, the deprotonated PDB file
                as produced by Reduce will be saved to this path.

        Returns:
            Protein: The deprotonated protein.
        &#34;&#34;&#34;

        # Create an in memory PDB file
        input_pdb_str = PDBIO.save_to_string(protein)

        # Remove hydrogen atoms from the structure.
        deprotonated_pdb_str = self._reduce_deprotonate(input_pdb_str)
        if reduce_output_pdb_file_path is not None:
            with open(reduce_output_pdb_file_path, &#34;w&#34;) as file:
                file.write(deprotonated_pdb_str)

        # Merge the deprotonated protein with the original protein
        protein_out = PDBIO.load_from_string(deprotonated_pdb_str)[0]
        protein_merged = ReduceAdaptor.merge_copy(protein, protein_out)

        return protein_merged</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="protkit.tasks.protonator.Protonator" href="../tasks/protonator.html#protkit.tasks.protonator.Protonator">Protonator</a></li>
<li>abc.ABC</li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="protkit.tools.reduce_adaptor.ReduceAdaptor.merge_copy"><code class="name flex">
<span>def <span class="ident">merge_copy</span></span>(<span>source_protein:Â <a title="protkit.structure.protein.Protein" href="../structure/protein.html#protkit.structure.protein.Protein">Protein</a>, updated_protein:Â <a title="protkit.structure.protein.Protein" href="../structure/protein.html#protkit.structure.protein.Protein">Protein</a>) â€‘>Â <a title="protkit.structure.protein.Protein" href="../structure/protein.html#protkit.structure.protein.Protein">Protein</a></span>
</code></dt>
<dd>
<div class="desc"><p>Merge the updated protein into the source protein. The source protein
is copied before the merge operation.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>source_protein</code></strong> :&ensp;<code>Protein</code></dt>
<dd>The source protein.</dd>
<dt><strong><code>updated_protein</code></strong> :&ensp;<code>Protein</code></dt>
<dd>The updated protein.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Protein</code></dt>
<dd>The merged protein.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def merge_copy(source_protein: Protein, updated_protein: Protein) -&gt; Protein:
    &#34;&#34;&#34;
    Merge the updated protein into the source protein. The source protein
    is copied before the merge operation.

    Args:
        source_protein (Protein): The source protein.
        updated_protein (Protein): The updated protein.

    Returns:
        Protein: The merged protein.
    &#34;&#34;&#34;
    merged_protein = source_protein.copy()
    ReduceAdaptor.merge_into(merged_protein, updated_protein)
    return merged_protein</code></pre>
</details>
</dd>
<dt id="protkit.tools.reduce_adaptor.ReduceAdaptor.merge_into"><code class="name flex">
<span>def <span class="ident">merge_into</span></span>(<span>source_protein:Â <a title="protkit.structure.protein.Protein" href="../structure/protein.html#protkit.structure.protein.Protein">Protein</a>, updated_protein:Â <a title="protkit.structure.protein.Protein" href="../structure/protein.html#protkit.structure.protein.Protein">Protein</a>)</span>
</code></dt>
<dd>
<div class="desc"><p>Merge the updated protein into the source protein. The source
protein is updated in place.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>source_protein</code></strong> :&ensp;<code>Protein</code></dt>
<dd>The source protein.</dd>
<dt><strong><code>updated_protein</code></strong> :&ensp;<code>Protein</code></dt>
<dd>The updated protein.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def merge_into(source_protein: Protein, updated_protein: Protein):
    &#34;&#34;&#34;
    Merge the updated protein into the source protein. The source
    protein is updated in place.

    Args:
        source_protein (Protein): The source protein.
        updated_protein (Protein): The updated protein.

    Returns:
        None
    &#34;&#34;&#34;
    for chain in updated_protein.chains:
        source_chain = source_protein.get_chain(chain.chain_id)
        if source_chain is None:
            source_protein.add_chain(chain.chain_id, chain)
        else:
            for index, residue in enumerate(chain.residues):
                source_residue = source_chain.get_residue(index)
                if source_residue is None:
                    source_chain.add_residue(residue)
                else:
                    for atom in residue.atoms:
                        source_atom = source_residue.get_atom(atom.atom_type)
                        if source_atom is None:
                            source_residue.add_atom(atom.atom_type, atom)
                        else:
                            source_atom.x = atom.x
                            source_atom.y = atom.y
                            source_atom.z = atom.z
                            if atom.has_attribute(&#34;temp_factor&#34;):
                                source_atom.set_attribute(&#34;temp_factor&#34;, atom.get_attribute(&#34;temp_factor&#34;))</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="protkit.tools.reduce_adaptor.ReduceAdaptor.deprotonate"><code class="name flex">
<span>def <span class="ident">deprotonate</span></span>(<span>self, protein:Â <a title="protkit.structure.protein.Protein" href="../structure/protein.html#protkit.structure.protein.Protein">Protein</a>, reduce_output_pdb_file_path:Â strÂ =Â None) â€‘>Â <a title="protkit.structure.protein.Protein" href="../structure/protein.html#protkit.structure.protein.Protein">Protein</a></span>
</code></dt>
<dd>
<div class="desc"><p>Deprotonate a protein using the Reduce software.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>protein</code></strong> :&ensp;<code>Protein</code></dt>
<dd>The protein to be deprotonated.</dd>
<dt><strong><code>reduce_output_pdb_file_path</code></strong> :&ensp;<code>str</code></dt>
<dd>If set, the deprotonated PDB file
as produced by Reduce will be saved to this path.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Protein</code></dt>
<dd>The deprotonated protein.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def deprotonate(self, protein: Protein, reduce_output_pdb_file_path: str=None) -&gt; Protein:
    &#34;&#34;&#34;
    Deprotonate a protein using the Reduce software.

    Args:
        protein (Protein): The protein to be deprotonated.
        reduce_output_pdb_file_path (str): If set, the deprotonated PDB file
            as produced by Reduce will be saved to this path.

    Returns:
        Protein: The deprotonated protein.
    &#34;&#34;&#34;

    # Create an in memory PDB file
    input_pdb_str = PDBIO.save_to_string(protein)

    # Remove hydrogen atoms from the structure.
    deprotonated_pdb_str = self._reduce_deprotonate(input_pdb_str)
    if reduce_output_pdb_file_path is not None:
        with open(reduce_output_pdb_file_path, &#34;w&#34;) as file:
            file.write(deprotonated_pdb_str)

    # Merge the deprotonated protein with the original protein
    protein_out = PDBIO.load_from_string(deprotonated_pdb_str)[0]
    protein_merged = ReduceAdaptor.merge_copy(protein, protein_out)

    return protein_merged</code></pre>
</details>
</dd>
<dt id="protkit.tools.reduce_adaptor.ReduceAdaptor.protonate"><code class="name flex">
<span>def <span class="ident">protonate</span></span>(<span>self, protein:Â <a title="protkit.structure.protein.Protein" href="../structure/protein.html#protkit.structure.protein.Protein">Protein</a>, reduce_output_pdb_file_path:Â strÂ =Â None) â€‘>Â <a title="protkit.structure.protein.Protein" href="../structure/protein.html#protkit.structure.protein.Protein">Protein</a></span>
</code></dt>
<dd>
<div class="desc"><p>Protonate a protein using the Reduce software.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>protein</code></strong> :&ensp;<code>Protein</code></dt>
<dd>The protein to be protonated.</dd>
<dt><strong><code>reduce_output_pdb_file_path</code></strong> :&ensp;<code>str</code></dt>
<dd>If set, the protonated PDB file
as produced by Reduce will be saved to this path.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Protein</code></dt>
<dd>The protonated protein.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def protonate(self, protein: Protein, reduce_output_pdb_file_path: str=None) -&gt; Protein:
    &#34;&#34;&#34;
    Protonate a protein using the Reduce software.

    Args:
        protein (Protein): The protein to be protonated.
        reduce_output_pdb_file_path (str): If set, the protonated PDB file
            as produced by Reduce will be saved to this path.

    Returns:
        Protein: The protonated protein.
    &#34;&#34;&#34;

    # Create an in memory PDB file
    input_pdb_str = PDBIO.save_to_string(protein)

    # Remove protons first, in case the structure is already protonated
    deprotonated_pdb_str = self._reduce_deprotonate(input_pdb_str)

    # Add hydrogens to the protein.
    protonated_pdb_str = self._reduce_protonate(deprotonated_pdb_str)
    if reduce_output_pdb_file_path is not None:
        with open(reduce_output_pdb_file_path, &#34;w&#34;) as file:
            file.write(protonated_pdb_str)

    # Merge the protonated protein with the original protein
    protein_out = PDBIO.load_from_string(protonated_pdb_str)[0]
    protein_merged = ReduceAdaptor.merge_copy(protein, protein_out)

    return protein_merged</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="protkit.tools.reduce_adaptor.ReduceDeprotonationError"><code class="flex name class">
<span>class <span class="ident">ReduceDeprotonationError</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Common base class for all non-exit exceptions.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ReduceDeprotonationError(Exception):
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>builtins.Exception</li>
<li>builtins.BaseException</li>
</ul>
</dd>
<dt id="protkit.tools.reduce_adaptor.ReduceProtonationError"><code class="flex name class">
<span>class <span class="ident">ReduceProtonationError</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Common base class for all non-exit exceptions.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ReduceProtonationError(Exception):
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>builtins.Exception</li>
<li>builtins.BaseException</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="protkit.tools" href="index.html">protkit.tools</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="protkit.tools.reduce_adaptor.ReduceAdaptor" href="#protkit.tools.reduce_adaptor.ReduceAdaptor">ReduceAdaptor</a></code></h4>
<ul class="">
<li><code><a title="protkit.tools.reduce_adaptor.ReduceAdaptor.deprotonate" href="#protkit.tools.reduce_adaptor.ReduceAdaptor.deprotonate">deprotonate</a></code></li>
<li><code><a title="protkit.tools.reduce_adaptor.ReduceAdaptor.merge_copy" href="#protkit.tools.reduce_adaptor.ReduceAdaptor.merge_copy">merge_copy</a></code></li>
<li><code><a title="protkit.tools.reduce_adaptor.ReduceAdaptor.merge_into" href="#protkit.tools.reduce_adaptor.ReduceAdaptor.merge_into">merge_into</a></code></li>
<li><code><a title="protkit.tools.reduce_adaptor.ReduceAdaptor.protonate" href="#protkit.tools.reduce_adaptor.ReduceAdaptor.protonate">protonate</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="protkit.tools.reduce_adaptor.ReduceDeprotonationError" href="#protkit.tools.reduce_adaptor.ReduceDeprotonationError">ReduceDeprotonationError</a></code></h4>
</li>
<li>
<h4><code><a title="protkit.tools.reduce_adaptor.ReduceProtonationError" href="#protkit.tools.reduce_adaptor.ReduceProtonationError">ReduceProtonationError</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>